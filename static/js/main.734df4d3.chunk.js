(this["webpackJsonpimage-processing-prototyper"]=this["webpackJsonpimage-processing-prototyper"]||[]).push([[0],{61:function(e,n,t){e.exports=t(76)},66:function(e,n,t){},67:function(e,n,t){e.exports=t.p+"static/media/logo.ee7cd8ed.svg"},68:function(e,n,t){},69:function(e,n,t){},76:function(e,n,t){"use strict";t.r(n);var o=t(0),a=t.n(o),r=t(7),i=t.n(r),c=(t(66),t(14)),s=(t(67),t(68),t(50)),l=t.n(s),d=t(109),u=t(54),g=t(16),p=t(113),m=t(112),f="card",v=(t(69),t(110)),h=function(e){var n=e.cardID,t=e.processingOptions,o=e.onChange;return a.a.createElement(a.a.Fragment,null,Object.keys(t).map((function(e){return a.a.createElement(v.a,{key:n+"-"+e,id:n+"-"+e,label:e,type:"number",placeholder:t[e].toString(),variant:"outlined",onChange:o,InputLabelProps:{shrink:!0},style:{marginTop:"10px"}})})))},w=function(e){var n=e.id,t=e.text,o=e.moveCard,r=e.findCard,i=e.deleteCard,s=e.processingOptions,l=e.updateCard,d=r(n).index,u=Object(m.a)({item:{type:f,id:n,originalIndex:d},collect:function(e){return{isDragging:e.isDragging()}},end:function(e,n){var t=n.getItem(),a=t.id,r=t.originalIndex;n.didDrop()||o(a,r)}}),g=Object(c.a)(u,2),v=g[0].isDragging,w=g[1],b=Object(p.a)({accept:f,canDrop:function(){return!1},hover:function(e){var t=e.id;if(t!==n){var a=r(n).index;o(t,a)}}}),E=Object(c.a)(b,2)[1],O=v?0:1;return a.a.createElement("div",{ref:function(e){return w(E(e))},style:{opacity:O},className:"card"},t,a.a.createElement("span",{className:"delete-button",onClick:function(){i(n)}},a.a.createElement("p",{className:"fa fa-trash"})),a.a.createElement("br",null),a.a.createElement("div",{className:"processing-parameters"},a.a.createElement(h,{cardID:n,processingOptions:s,onChange:function(e){for(var t=e.target.parentElement.parentElement.getElementsByTagName("label"),o=0;o<t.length;o++)if(t[o].htmlFor===e.target.id){var a=t[o].textContent;console.debug("received a change with the value: ".concat(e.target.value," of type ").concat(typeof e.target.value," for property ").concat(a)),l(n,a,Number.parseInt(e.target.value));break}}})))},b=t(32),E=t.n(b),O={_cannyEdgeDetection:function(e,n,t){window.cv.Canny(e,n,t.lowerThreshold,t.upperThreshold,t.sobelApertureSize,t.moreAccurateGradient)},_histogramEqualization:function(e,n,t){window.cv.cvtColor(e,e,window.cv.COLOR_RGBA2GRAY,0),window.cv.equalizeHist(e,n)},_medianFilter:function(e,n,t){window.cv.medianBlur(e,n,t.kernelSize)},_convertRGBToGray:function(e,n,t){window.cv.cvtColor(e,n,window.cv.COLOR_RGBA2GRAY,0)},_simpleBinaryThresholding:function(e,n,t){window.cv.threshold(e,n,t.threshVal,255,window.cv.THRESH_BINARY)},_otsuThresholding:function(e,n,t){window.cv.cvtColor(e,e,window.cv.COLOR_RGBA2GRAY,0),window.cv.threshold(e,n,69,255,window.cv.THRESH_OTSU)},_adaptiveThresholding:function(e,n,t){window.cv.cvtColor(e,e,window.cv.COLOR_RGBA2GRAY,0),window.cv.adaptiveThreshold(e,n,t.maxValue,window.cv.ADAPTIVE_THRESH_GAUSSIAN_C,window.cv.THRESH_BINARY,t.kernelSize,t.C)}};function x(e,n,t,o){console.debug("---- Executing algorithm: ".concat(o," ----")),console.debug("showing some debug information for the algorithm to execute"),console.debug("input canvas:"),console.debug(e),console.debug("output canvas:"),console.debug(document.getElementById(n)),console.debug("function to execute:"),console.debug(o),console.debug("================");var a=window.cv.imread(e),r=new window.cv.Mat;return o(a,r,t),window.cv.imshow(n,r),a.delete(),r.delete(),document.getElementById(n)}var y=[{id:1,algoID:1,text:"RGB to Grayscale",processingOptions:{}},{id:2,algoID:2,text:"Histogram Equalization",processingOptions:{}},{id:3,algoID:3,text:"Simple Image Thresholding",processingOptions:{threshVal:127}},{id:4,algoID:4,text:"Median Filtering",processingOptions:{kernelSize:5}},{id:5,algoID:5,text:"Canny Edge Detection",processingOptions:{lowerThreshold:50,upperThreshold:100,sobelApertureSize:3,moreAccurateGradient:!1}},{id:6,algoID:6,text:"Otsu Binarization",processingOptions:{}},{id:7,algoID:7,text:"Adaptive Thresholding",processingOptions:{maxValue:200,kernelSize:3,C:2}}];function C(e){var n=function(){},t=y.filter((function(n){return n.algoID===e}))[0].text,o=y.filter((function(n){return n.algoID===e}))[0].processingOptions;switch(e){case 1:n=O._convertRGBToGray;break;case 2:n=O._histogramEqualization;break;case 3:n=O._simpleBinaryThresholding;break;case 4:n=O._medianFilter;break;case 5:n=O._cannyEdgeDetection;break;case 6:n=O._otsuThresholding;break;case 7:n=O._adaptiveThresholding}return[n,t,o]}var I=t(52),T=t(114),D=t(111),R=function(e){var n=e.cards,t=e.setCards,r=Object(o.useState)({algoID:1,processingOptions:{}}),i=Object(c.a)(r,2),s=i[0],l=i[1],d=function(e,o){var a=m(e),r=a.card,i=a.index;t(E()(n,{$splice:[[i,1],[o,0,r]]}))},u=function(e){var o=m(e),a=(o.card,o.index);console.log("aiyoh ".concat(e," kena delete")),t(E()(n,{$splice:[[a,1]]}))},m=function(e){var t=n.filter((function(n){return"".concat(n.id)===e}))[0];return{card:t,index:n.indexOf(t)}},v=function(e,o,a){var r=m(e),i=(r.card,r.index);console.debug("got a value of ".concat(a," for property ").concat(o," in updateCard")),t(E()(n,Object(g.a)({},i,{processingOptions:Object(g.a)({},o,{$set:a})})))},b=Object(p.a)({accept:f,drop:function(){}}),O=Object(c.a)(b,2)[1];return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",maxWidth:"30vw"}},a.a.createElement("div",{ref:O,className:"drag-and-drop-container"},a.a.createElement("h2",null,"Algorithms to run on input video (in order from top to bottom)"),n.map((function(e){return a.a.createElement(w,{key:e.id,id:"".concat(e.id),text:e.text,moveCard:d,findCard:m,deleteCard:u,processingOptions:e.processingOptions,updateCard:v})}))),a.a.createElement("form",{style:{marginTop:"50px",border:"1px gray",padding:"0.5rem 1rem",marginBottom:".5rem",backgroundColor:"white",color:"black",display:"flex",flexDirection:"column",textAlign:"left"}},a.a.createElement("p",{style:{textDecoration:"underline",textAlign:"center"}},"Add a new processing card"),a.a.createElement(T.a,{shrink:!0,htmlFor:"select-new-algo"},"Algorithm Options"),a.a.createElement(I.a,{onChange:function(e){var n=Number.parseInt(e.target.value),t=C(n),o=Object(c.a)(t,3)[2];console.debug("setting new card with parameters:"),console.debug("algoID: ".concat(n," of type ").concat(typeof n)),console.debug("processing options:"),console.debug(o),l({algoID:n,processingOptions:o})},inputProps:{id:"select-new-algo"}},y.map((function(e,n){return a.a.createElement("option",{key:n,value:e.algoID},e.text)}))),a.a.createElement("label",{htmlFor:"options-for-algo"}),a.a.createElement("div",{id:"options-for-algo"},a.a.createElement(h,{cardID:-1,processingOptions:s.processingOptions,onChange:function(e){}})),a.a.createElement(D.a,{variant:"contained",style:{marginTop:"30px"},id:"add-algo",onClick:function(e){e.preventDefault(),console.debug(s.algoID),console.debug(s.processingOptions),function(e,o){var a=C(e),r=Object(c.a)(a,2)[1];console.debug(e),console.debug(typeof e),console.debug(o),t(E()(n,{$push:[{id:Math.max.apply(Math,n.map((function(e){return e.id+1}))),algoID:e,text:r,processingOptions:o}]}))}(s.algoID,s.processingOptions)}},"Add new algorithm")))},A=function(e){var n=e.cards;return a.a.createElement("div",{className:"daPipeline"},n.map((function(e,n){return a.a.createElement("canvas",{key:"intermediate-output-"+n,id:"intermediate-output-"+n})})))};function k(e){if("undefined"===typeof e)e="";else if("number"===typeof e)isNaN(e)||"undefined"!==typeof cv&&(e="Exception: "+window.cv.exceptionFromPtr(e).msg);else if("string"===typeof e){var n=Number(e.split(" ")[0]);isNaN(n)||"undefined"!==typeof cv&&(e="Exception: "+window.cv.exceptionFromPtr(n).msg)}else e instanceof Error&&(e=e.stack.replace(/\n/g,"<br>"));return e}var N=function(){Object(o.useEffect)((function(){if(window.webcam||(window.webcam=e.current),window.cv){console.log("opencv loaded");var n=setInterval((function(){var e=window.webcam.getCanvas();if(e)for(var n=e,t=0;t<r.length;t++){var o=r[t];console.debug("----- CURRENT CARD STATUSES ----"),console.debug("CURRENT CANVAS TO INPUT FROM:"),console.debug(n),console.debug("CURRENT CANVAS TO OUTPUT TO:"),console.debug("intermediate-output-"+t),console.debug("CURRENT SET OF PROCESSING OPTIONS"),console.debug(o.processingOptions),console.debug("///////////");try{var a=C(o.algoID),i=Object(c.a)(a,2)[0];n=x(n,"intermediate-output-"+t,o.processingOptions,i)}catch(s){console.error("Error using algorithm of id ".concat(o.id,", error message: ").concat(k(s)))}}}),500);return function(){return clearInterval(n)}}console.log("opencv not loaded, will exit")}));var e=a.a.useRef(null),n=Object(o.useState)(y),t=Object(c.a)(n,2),r=t[0],i=t[1];return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"processing-interface"},a.a.createElement("div",{className:"video-pipeline"},a.a.createElement("h2",null,"Video Input and Intermediate Outputs (in order from top to bottom)"),a.a.createElement(l.a,{audio:!1,ref:e,screenshotFormat:"image/jpeg",videoConstraints:{width:1280,height:720,facingMode:"user"},onUserMedia:function(){window.webcam=e.current}}),a.a.createElement(A,{cards:r})),a.a.createElement(d.a,{backend:u.a},a.a.createElement(R,{cards:r,setCards:i}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(75);i.a.render(a.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[61,1,2]]]);
//# sourceMappingURL=main.734df4d3.chunk.js.map